<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" xmlns:pm="http://primefaces.org/ui">

<h:head><title>Pagos de instructor</title></h:head>
<body>
	<ui:include src="header.xhtml" />
	<h:form id="form">
		<div>
			<pm:fieldset>
				<h:panelGrid id="student" columns="2" cellpadding="5">
					<p:outputLabel value="Instructor:" />
					<p:outputLabel value="#{MbPaymentByInstructor.nameInstructor}" />
				</h:panelGrid>
			</pm:fieldset>
		</div>

		<p:dataTable id="checkboxDT" var="lp" value="#{MbPaymentByInstructor.listaPsp}"
			selection="#{MbPaymentByInstructor.temListaPsp}" rowKey="#{lp.numPayment}"
			paginator="true" rows="10"
			paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
			filteredValue="#{MbPaymentByInstructor.filterPayments}" style="margin-bottom:0">

			<f:facet name="header">
            Pagos
        </f:facet>
			<p:column selectionMode="multiple"
				style="width:16px;text-align:center" />
			<p:column headerText="Fecha" style="width:120px">
				<h:outputText value="#{lp.datePayment}" />
			</p:column>
			<p:column headerText="No Pago">
				<h:outputText value="#{lp.numPayment}" />
			</p:column>
			<p:column headerText="Curso">
				<h:outputText value="#{lp.courseName}" />
			</p:column>
			<p:column headerText="Monto">
				<h:outputText value="#{lp.amountPayment}" />
			</p:column>
			<p:column headerText="Forma de pago">
				<h:outputText value="#{lp.typePayment}" />
			</p:column>
		</p:dataTable>

		<pm:fieldset>
			<h:panelGrid id="totals" columns="2" cellpadding="5">
				<p:outputLabel value="Costo curso: " />
				<p:outputLabel value="#{MbPaymentByInstructor.totalCourse}" />

				<p:outputLabel value="Total pagado: " />
				<p:outputLabel value="#{MbPaymentByInstructor.totalPayment}" />

				<p:outputLabel value="Restante: " />
				<p:outputLabel value="#{MbPaymentByInstructor.remaining}" />
			</h:panelGrid>
		</pm:fieldset>

		<p:toolbar>
			<f:facet name="left">
				<p:commandButton value="Generar pago(s)"
					actionListener="#{MbPaymentByInstructorController.createReport()}"
					icon="ui-icon-document" tabindex="1"/>
			</f:facet>
			<f:facet name="right">
				<p:commandButton value="Atras" action="back" tabindex="2"/>
			</f:facet>
		</p:toolbar>

		<p:dialog id="rExito" widgetVar="exito" closable="false" modal="true"
			header="Mensaje" height="50px" width="350px" draggable="false"
			resizable="false">
			<p:fieldset>
				<p:outputLabel value="Recibo(s) generado(s) con exito" />
			</p:fieldset>

			<f:facet name="footer">
				<p:commandButton value="Enviar" actionListener="#{MbPaymentByInstructorController.addAttribute()}" 
				action="envioCorreoInstructor" />
				<p:commandButton value="Cancelar" onclick="PF().hide()" />
			</f:facet>
		</p:dialog>

		<p:dialog id="rVacio" widgetVar="vacio" closable="false" modal="true"
			header="Mensaje" height="50px" width="350px" draggable="false"
			resizable="false">
			<p:fieldset>
				<p:outputLabel value="No hay recibos selecionados" />
			</p:fieldset>

			<f:facet name="footer">
				<p:commandButton value="Aceptar" onclick="PF().hide()" />
			</f:facet>
		</p:dialog>

		<p:dialog id="rFallido" widgetVar="fallido" closable="false"
			modal="true" header="Mensaje" height="50px" width="350px"
			draggable="false" resizable="false">
			<p:fieldset>
				<p:outputLabel value="No se han podido generar los recibos" />
			</p:fieldset>

			<f:facet name="footer">
				<p:commandButton value="Aceptar" onclick="PF().hide()" />
			</f:facet>
		</p:dialog>

	</h:form>
</body>
</html>
